const name_input=document.getElementById("name");name_input.value=localStorage.getItem("name"),name_input.addEventListener("change",(()=>{localStorage.setItem("name",name_input.value)}));let items=[];items=JSON.parse(localStorage.getItem("items"))||Array.prototype;class Item{constructor(e,t,n){this.front=e,this.back=t,this.type=n,this.stage=0,this.reviewDate=new Date}}function AddItem(e,t,n){items.push(new Item(e,t,n)),localStorage.setItem("items",JSON.stringify(items)),findDueItems()}let due_item_indexes=[],shuffled_due_item_indexes=[];function shuffleDueItems(){shuffled_due_item_indexes=[...due_item_indexes];for(let e=0;e<shuffled_due_item_indexes.length;e++){let t=Math.floor(Math.random()*shuffled_due_item_indexes.length);[shuffled_due_item_indexes[e],shuffled_due_item_indexes[t]]=[shuffled_due_item_indexes[t],shuffled_due_item_indexes[e]]}}let currentReviewIndex=0;const prompt_label=document.getElementById("prompt");function updateCard(){items.length>0?prompt_label.innerText=items[shuffled_due_item_indexes[currentReviewIndex]].front:prompt_label.innerText="why are you here?"}function findDueItems(){let e=Date.parse(new Date);for(let t=0;t<items.length;t++)Date.parse(items[t].reviewDate)-e<0&&due_item_indexes.push(t);shuffleDueItems(),updateCard()}const reviews_form=document.getElementById("reviews-form"),reviews_input=document.getElementById("reviews-input");reviews_form.addEventListener("submit",(e=>{e.preventDefault(),reviews_input.value==items[shuffled_due_item_indexes[currentReviewIndex]].back&&alert("success!")}));const backup_button=document.getElementById("generate-backup");backup_button.addEventListener("click",(()=>{let e=btoa(localStorage.getItem("items")),t=document.createElement("p");t.innerText=e,t.style.display="none",document.body.append(t),navigator.clipboard.writeText(t.innerText),t.remove()}));const recovery_input=document.getElementById("recover-input"),recovery_button=document.getElementById("recover-button");recovery_button.addEventListener("click",(()=>{items=items.concat(JSON.parse(atob(recovery_input.value))||[]),localStorage.setItem("items",JSON.stringify(items)),findDueItems()}));const home=document.getElementById("home"),creator=document.getElementById("creator"),reviews=document.getElementById("reviews"),creator_button=document.getElementById("creator-button"),review_button=document.getElementById("review-button"),home_button_from_creator=document.getElementById("creator-back"),home_button_from_reviews=document.getElementById("reviews-back");creator_button.addEventListener("click",(()=>{home.classList.add("hidden"),creator.classList.remove("hidden")})),home_button_from_creator.addEventListener("click",(()=>{home.classList.remove("hidden"),creator.classList.add("hidden"),findDueItems()})),review_button.addEventListener("click",(()=>{home.classList.add("hidden"),reviews.classList.remove("hidden"),currentReviewIndex=0})),home_button_from_reviews.addEventListener("click",(()=>{home.classList.remove("hidden"),reviews.classList.add("hidden"),findDueItems()}));const front_side_creator_input=document.getElementById("creator-front"),back_side_creator_input=document.getElementById("creator-input-back"),add_to_deck_button=document.getElementById("creator-create-button");add_to_deck_button.addEventListener("click",(()=>{""!=front_side_creator_input.value&&""!=back_side_creator_input&&(AddItem(front_side_creator_input.value,back_side_creator_input.value,"type_in"),review_button.innerHTML=due_item_indexes.length+" reviews"),front_side_creator_input.value="",back_side_creator_input.value=""})),findDueItems(),review_button.innerHTML=due_item_indexes.length+" reviews";